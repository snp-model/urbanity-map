# Urbanity Map

全国市町村の「都会度」と「光害度」を可視化するインタラクティブマップアプリケーション。

## 概要

Urbanity Map は、日本全国の市町村ごとに「都会度」と「光害度」のスコアを算出し、地図上で視覚的に表示する Web アプリケーションです。移住検討者や一般ユーザーが、各地域の都市機能の充実度や夜空の見やすさを直感的に把握できます。

## 主な機能

- 🏙️ **都会度表示**: 夜間光・人口・POIの3層統合スコアによる都市機能の可視化
- ⭐ **光害度表示**: 夜間光データによる光害レベルの可視化（星空の見やすさ）
- 🗾 **全国対応**: 日本全国の市区町村（約1,900自治体）をカバー
- 🎨 **動的カラーリング**: モードに応じた直感的な色分け表示
- 📊 **詳細情報**: 市区町村をクリックしてスコア詳細を表示

## プロジェクト構成

```
urbanity-map/
├── docs/                    # ドキュメント
│   ├── 01_調査/             # 調査資料
│   ├── 02_要件定義/         # 要件定義書・ADR
│   ├── 03_設計/             # システム設計書
│   └── DATA_PREPARATION.md  # データ準備ガイド
├── frontend/                # フロントエンドアプリケーション (React + Vite)
│   └── public/data/         # 処理済みデータ（Gitに含まれる、約13MB）
├── scripts/                 # データ処理スクリプト (Python)
├── data/                    # ソースデータ（Gitに含まれない、約5.9GB）
└── README.md
```

## 技術スタック

### フロントエンド
- **React 18**: UIライブラリ
- **TypeScript**: 型安全性
- **Vite**: 高速ビルドツール
- **MapLibre GL JS**: オープンソース地図ライブラリ
- **Vanilla CSS**: スタイリング

### データ処理
- **Python 3.11+**: データ処理言語
- **uv**: Pythonパッケージマネージャー
- **GeoPandas**: 地理空間データ処理
- **Rasterio**: ラスターデータ処理

### データソース
- **国土地理院**: 地図タイル、市区町村境界データ
- **VIIRS**: 夜間光データ
- **e-Stat**: 人口メッシュデータ
- **OpenStreetMap**: POI（施設）データ

## クイックスタート

### フロントエンドの起動

```bash
# フロントエンドのセットアップ
cd frontend
npm install
npm run dev
```

ブラウザで http://localhost:5173 を開いてください。

### データの準備（初回のみ）

処理済みデータはGitリポジトリに含まれているため、通常は不要です。
データを再生成する場合は、[データ準備ガイド](docs/DATA_PREPARATION.md)を参照してください。

## データ管理

### Gitに含まれるデータ（約13MB）
- `frontend/public/data/` - 処理済みデータ（アプリケーション実行に必須）
  - `japan-with-scores-v2.geojson` - スコア付き市区町村境界
  - `urbanity-score-v2.json` - 統合スコアJSON
  - その他のスコアファイル

### Gitから除外されるデータ（約5.9GB）
- `data/` - ソースデータ（再ダウンロード・再生成可能）
  - OpenStreetMapデータ
  - 人口メッシュデータ
  - 夜間光データ
  - 市区町村境界データ

## ドキュメント

| ドキュメント | 説明 |
|-------------|------|
| [データ準備ガイド](docs/DATA_PREPARATION.md) | データのダウンロードと処理手順 |
| [フロントエンドREADME](frontend/README.md) | フロントエンドの詳細情報 |
| [スクリプトREADME](scripts/README.md) | データ処理スクリプトの詳細 |
| [要件定義書](docs/02_要件定義/requirements.md) | プロジェクトの要件定義 |
| [システム設計書](docs/03_設計/system_design.md) | システムアーキテクチャ |
| [ADR-001: タイルサーバー選定](docs/02_要件定義/ADR/001_タイルサーバー選定.md) | タイルサーバーの選定理由 |

## スコアの算出方法

### 都会度スコア
3層のデータを加重平均して算出：
- **夜間光**: 40%（活動量の指標）
- **人口**: 30%（定住量の指標）
- **POI**: 30%（利便性の指標）

### 光害度スコア
夜間光データをそのまま使用（0-100で正規化）

## ライセンス

MIT License