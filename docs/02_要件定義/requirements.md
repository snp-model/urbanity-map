# 要件定義書

## 1. プロジェクト概要
全国の市町村ごとの「都会度」を算出し、地図上で可視化するWebサービス「Urbanity Map（仮）」を構築する。
ユーザーは移住先検討や、自身の居住地の都会度確認、または単なるエンターテインメントとしてこれを利用する。

## 2. ターゲットユーザーとユースケース
- **移住検討者**: 「程よい都会」「生活に困らないレベルの田舎」など、自分に合った地域を探す。
- **一般ユーザー**: 自分の住んでいる街や出身地の都会度を見て楽しむ。SNSでシェアする。
- **データ愛好家**: 都市構造や地理データに興味がある層。

## 3. 「都会度」の定義とモデル化
行政区域（市町村）ごとに1つの「都会度スコア」を算出する。
既存調査に基づき、**「機能的都会度」**を採用する。

### 3.1 採用する指標
以下の3つの要素を主軸にスコア化する。
1. **コンビニエンスストア密度・アクセス性**: 24時間の活動強度、利便性の指標。
2. **スーパーマーケット密度・アクセス性**: 定住生活の基盤、生活維持機能の指標。
3. **飲食店密度**: 文化的・社会的活動、夜間経済の指標。

※ 補完的に**人口密度**や**昼夜間人口比率**も考慮に入れる可能性があるが、まずは上記POI（Point of Interest）データを重視する。

### 3.2 算出ロジックの概要（予定）
1. 各施設タイプについて、市町村ごとの「可住地面積あたりの店舗数」または「主要居住域からの平均距離」を算出。
2. 各指標を正規化（0-100等のスコアに変換）。
3. 重み付けを行って合算し、総合「都会度スコア」とする。

## 4. 機能要件

### 4.1 ユーザーインターフェース (UI)
- **日本地図表示**: 全国を俯瞰でき、ズーム操作が可能。
- **色分け表示**: 市町村のポリゴンを都会度スコアに応じて色分け（例：ヒートマップカラー）。
- **詳細情報表示**:
    - 市町村をクリック/タップすると、詳細モーダルまたはサイドパネルが開く。
    - 総合スコア、各構成要素（コンビニ度、スーパー度など）のスコアを表示。
- **検索機能**: 市町村名で検索し、該当箇所へズームおよびハイライト。

### 4.2 システム要件
- **静的サイト生成 (SSG)**: サーバーサイドで動的に計算するのではなく、事前に計算済みのGeoJSON/タイルデータを配信する。
- **更新頻度**: 1ヶ月〜1年に1回程度。バッチ処理でデータを更新し、デプロイする運用。

## 5. 非機能要件
- **パフォーマンス**: 大量のポリゴンデータを扱うため、レンダリング速度（MVT: Mapbox Vector Tilesの使用など）に配慮する。
- **デバイス対応**: PCおよびスマートフォンで閲覧可能であること。

## 6. 技術スタック案
- **フロントエンド**: React, TypeScript, MapLibre GL JS (または Leaflet)
- **データ処理**: Python (Pandas, GeoPandas)
- **ホスティング**: GitHub Pages, Vercel, or AWS S3 + CloudFront
- **地図データ**: OpenStreetMap, 国土数値情報
