# 都会度モデル化：最終結論とプロトタイプ計画

## 1. 最終決定：最善の組み合わせ（ベストミックス）

調査結果に基づき、以下の3つのデータを組み合わせた**「3層レイヤーモデル」**を最終的な推奨手法とします。

| レイヤー | データソース | 役割 | 理由 |
|----------|--------------|------|------|
| **① ベース層（活動量）** | **夜間光データ (VIIRS)** | 都市の「規模・エネルギー」を測定 | 昼間人口や経済活動を含めた総合的な「都会の活動量」を最も広域かつ客観的に捉えられるため。 |
| **② 居住層（定住量）** | **500m人口メッシュ** | 都市の「住人の厚み」を測定 | 夜間光だけでは区別できない「工場地帯」と「住宅密集地」を識別するため。政府統計で信頼性が高い。 |
| **③ 機能層（利便性）** | **店舗POI密度** | 都市の「便利さ」を測定 | コンビニ・スーパーの密度により、数値だけでは測れない「生活実感としての都会度」を補正するため。 |

### なぜこの組み合わせか？
- **夜間光 × 人口**: 「人はいないが明るい（工業地帯）」や「人はいるが暗い（ベッドタウン）」といった都市の性格を分類できます。
- **× 店舗POI**: これに「店がある」という情報を加えることで、「住みやすく、かつ活気がある」真の都会度をスコア化できます。

---

## 2. プロトタイプ（簡易版）の実装方針

プロトタイプとしては、データ処理の複雑さを最小限に抑えつつ、視覚的なインパクトと有用性を確認できる**「Night Light（夜間光）単独モデル」**の作成を推奨します。

### プロトタイプ構成案

#### 🎯 コンセプト
**「日本で最も輝いている街はどこか？ 夜間光マップ」**
人口密度マップはありふれていますが、夜間光による行政区画ごとの色分け地図は新鮮味があり、都市の実態（商圏や工業集積）を直感的に可視化できます。

#### 🛠️ 使用データ
1.  **行政区域ポリゴン**: `SmartNews/japan-topography` (TopoJSON)
2.  **夜間光データ**: `日本VIIRS夜間光データ (yo5uke.com)` (GeoTIFF)

#### 🚀 実装ステップ

**Step 1: データ取得（手動）**
- 「日本VIIRS夜間光データ（2023年または2024年）」をダウンロード。
- 日本の市区町村TopoJSONをダウンロード。

**Step 2: データ加工（Pythonスクリプト）**
- GeoTIFF（ラスターデータ）と行政区域ポリゴン（ベクターデータ）を重ね合わせる。
- **Zonal Statistics（ゾーン統計）**処理を行い、各市区町村ポリゴン内の「平均輝度」を算出する。
- 結果をJSON形式で保存（例: `{"13101": 85.4, "13102": 72.1...}`）。

**Step 3: フロントエンド実装（React/MapLibre）**
- MapLibre GL JSで日本地図を表示。
- 算出したJSONデータを読み込み、市区町村ポリゴンを輝度スコアに応じて色分け（例: 黒→黄色→白のグラデーション）。

### このプロトタイプの利点
1.  **実装が速い**: 複雑なネットワーク解析（道路距離計算など）が不要。単なる「重ね合わせ集計」のみ。
2.  **技術検証になる**: 「大きなラスターデータからポリゴンごとの集計を行う」という処理は、将来的に人口データや土地利用データを扱う際にも共通して使える技術（Zonal Statistics）です。
3.  **結果が面白い**: 人口とは違った「明るさ」ランクが出るため、ユーザーの興味を引きやすい。

## 3. 次のアクション

プロトタイプ開発に向けて、以下の作業を進めることを提案します。

1.  **Python環境のセットアップ**: 地理空間情報処理ライブラリ (`rasterio`, `geopandas`, `rasterstats`) の導入。
2.  **データダウンロード**: 必要なファイルの入手。
3.  **集計スクリプト作成**: GeoTIFFから市区町村別平均値を算出するスクリプトの実装。
